<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Conductor Server - Conductor</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../css/custom.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Conductor Server";
    var mkdocs_page_input_path = "server.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Conductor</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../architecture/">Architecture</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Getting Started</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../gettingstarted/basicconcepts/">Basic Concepts</a>
                </li>
                <li class="">
                    
    <a class="" href="../gettingstarted/client/">Using the Client</a>
                </li>
                <li class="">
                    
    <a class="" href="../gettingstarted/startworkflow/">Start a Workflow</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Configuration</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../configuration/taskdef/">Task Definition</a>
                </li>
                <li class="">
                    
    <a class="" href="../configuration/workflowdef/">Workflow Definition</a>
                </li>
                <li class="">
                    
    <a class="" href="../configuration/systask/">System Tasks</a>
                </li>
                <li class="">
                    
    <a class="" href="../configuration/eventhandlers/">Event Handlers</a>
                </li>
                <li class="">
                    
    <a class="" href="../configuration/taskdomains/">Task Domains</a>
                </li>
                <li class="">
                    
    <a class="" href="../configuration/isolationgroups/">Isolation Groups</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Conductor Server</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#installing">Installing</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#requirements">Requirements</a></li>
        
        </ul>
    

    <li class="toctree-l2"><a href="#configuration">Configuration</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#configuration-parameters">Configuration Parameters</a></li>
        
        </ul>
    

    <li class="toctree-l2"><a href="#high-availability-configuration">High Availability Configuration</a></li>
    

    <li class="toctree-l2"><a href="#using-standalone-redis-elasticache">Using Standalone Redis / ElastiCache</a></li>
    

    <li class="toctree-l2"><a href="#setting-up-zookeeper-to-enable-distributed-locking-service">Setting up Zookeeper to enable Distributed Locking Service.</a></li>
    

    <li class="toctree-l2"><a href="#default-workflow-archiving-module-configuration">Default Workflow Archiving Module Configuration</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#1-enable-archiving-module">1. Enable Archiving Module</a></li>
        
            <li><a class="toctree-l3" href="#2-enable-workflow-status-listener">2. Enable Workflow Status Listener</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../apispec/">API Specification</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Conductor Metrics</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../metrics/server/">Server Metrics</a>
                </li>
                <li class="">
                    
    <a class="" href="../metrics/client/">Client Metrics</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../extend/">Extending Conductor</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../tasklifecycle/">Task Lifecycle</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../externalpayloadstorage/">External Payload Storage</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Developer Labs</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../labs/beginner/">Beginner</a>
                </li>
                <li class="">
                    
    <a class="" href="../labs/eventhandlers/">Events and Event Handlers</a>
                </li>
                <li class="">
                    
    <a class="" href="../labs/kitchensink/">Kitchensink</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../bestpractices/">Best Practices</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../faq/">FAQ</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../technicaldetails/">Technical Details</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../license/">License</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Conductor</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Conductor Server</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/Netflix/conductor/edit/dev/docs/docs/server.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="installing">Installing<a class="headerlink" href="#installing" title="Permanent link">&para;</a></h2>
<h3 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Database</strong>: <a href="https://github.com/Netflix/dynomite">Dynomite</a></li>
<li><strong>Indexing Backend</strong>: <a href="https://www.elastic.co">Elasticsearch 5.x</a></li>
<li><strong>Servlet Container</strong>: Tomcat, Jetty, or similar running JDK 1.8 or higher</li>
</ol>
<p>There are 3 ways in which you can install Conductor:</p>
<h4 id="1-build-from-source">1. Build from source<a class="headerlink" href="#1-build-from-source" title="Permanent link">&para;</a></h4>
<p>To build from source, checkout the code from github and build server module using <code>gradle build</code> command. If you do not have gradle installed, you can run the command <code>./gradlew build</code> from the project root. This produces <em>conductor-server-all-VERSION.jar</em> in the folder <em>./server/build/libs/</em></p>
<p>The jar can be executed using:</p>
<pre class="codehilite"><code class="language-shell">java -jar conductor-server-VERSION-all.jar</code></pre>


<h4 id="2-download-pre-built-binaries-from-jcenter-or-maven-central">2. Download pre-built binaries from jcenter or maven central<a class="headerlink" href="#2-download-pre-built-binaries-from-jcenter-or-maven-central" title="Permanent link">&para;</a></h4>
<p>Use the following coordinates:</p>
<table>
<thead>
<tr>
<th>group</th>
<th>artifact</th>
<th>version</th>
</tr>
</thead>
<tbody>
<tr>
<td>com.netflix.conductor</td>
<td>conductor-server-all</td>
<td>2.7.+</td>
</tr>
</tbody>
</table>
<h4 id="3-use-the-pre-configured-docker-image">3. Use the pre-configured Docker image<a class="headerlink" href="#3-use-the-pre-configured-docker-image" title="Permanent link">&para;</a></h4>
<p>To build the docker images for the conductor server and ui run the commands:</p>
<pre class="codehilite"><code class="language-shell">cd docker
docker-compose build</code></pre>


<p>After the docker images are built, run the following command to start the containers:</p>
<pre class="codehilite"><code class="language-shell">docker-compose up</code></pre>


<p>This will create a docker container network that consists of the following images: conductor:server, conductor:ui, <a href="https://hub.docker.com/_/elasticsearch/">elasticsearch:5.6.8</a>, and dynomite.</p>
<p>To view the UI, navigate to <a href="http://localhost:5000/">localhost:5000</a>, to view the Swagger docs, navigate to <a href="http://localhost:8080/">localhost:8080</a>.</p>
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h2>
<p>Conductor server uses a property file based configuration.  The property file is passed to the Main class as a command line argument.</p>
<pre class="codehilite"><code class="language-shell">java -jar conductor-server-all-VERSION.jar [PATH TO PROPERTY FILE] [log4j.properties file path]</code></pre>


<p>log4j.properties file path is optional and allows finer control over the logging (defaults to INFO level logging in the console).</p>
<h4 id="configuration-parameters">Configuration Parameters<a class="headerlink" href="#configuration-parameters" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-properties"># Database persistence model.  Possible values are memory, redis, redis_cluster, redis_sentinel and dynomite.
# If omitted, the persistence used is memory
#
# memory : The data is stored in memory and lost when the server dies.  Useful for testing or demo
# redis : non-Dynomite based redis instance
# redis_cluster: AWS Elasticache Redis (cluster mode enabled).See [http://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/Clusters.Create.CON.RedisCluster.html]
# redis_sentinel: Redis HA with Redis Sentinel. See [https://redis.io/topics/sentinel]
# dynomite : Dynomite cluster.  Use this for HA configuration.
db=dynomite

# Dynomite Cluster details.
# format is host:port:rack separated by semicolon
# for AWS Elasticache Redis (cluster mode enabled) the format is configuration_endpoint:port:us-east-1e. The region in this case does not matter
workflow.dynomite.cluster.hosts=host1:8102:us-east-1c;host2:8102:us-east-1d;host3:8102:us-east-1e

# If you are running using dynomite, also add the following line to the property 
# to set the rack/availability zone of the conductor server to be same as dynomite cluster config
EC2_AVAILABILTY_ZONE=us-east-1c

# Dynomite cluster name
workflow.dynomite.cluster.name=dyno_cluster_name

# Maximum connections to redis/dynomite
workflow.dynomite.connection.maxConnsPerHost=31

# Namespace for the keys stored in Dynomite/Redis
workflow.namespace.prefix=conductor

# Namespace prefix for the dyno queues
workflow.namespace.queue.prefix=conductor_queues

# No. of threads allocated to dyno-queues (optional)
queues.dynomite.threads=10

# Non-quorum port used to connect to local redis.  Used by dyno-queues.
# When using redis directly, set this to the same port as redis server.
# For Dynomite, this is 22122 by default or the local redis-server port used by Dynomite.
queues.dynomite.nonQuorum.port=22122

# Transport address to elasticsearch
# Specifying multiple node urls is not supported. specify one of the nodes' url, or a load balancer.
workflow.elasticsearch.url=localhost:9300

# Name of the elasticsearch cluster
workflow.elasticsearch.index.name=conductor

# Additional modules (optional)
conductor.additional.modules=class_extending_com.google.inject.AbstractModule</code></pre>


<h2 id="high-availability-configuration">High Availability Configuration<a class="headerlink" href="#high-availability-configuration" title="Permanent link">&para;</a></h2>
<p>Conductor servers are stateless and can be deployed on multiple servers to handle scale and availability needs.  The scalability of the server is achieved by scaling the <a href="https://github.com/Netflix/dynomite">Dynomite</a> cluster along with <a href="https://github.com/Netflix/dyno-queues">dyno-queues</a> which is used for queues.</p>
<p>Clients connects to the server via HTTP load balancer or using Discovery (on NetflixOSS stack).</p>
<h2 id="using-standalone-redis-elasticache">Using Standalone Redis / ElastiCache<a class="headerlink" href="#using-standalone-redis-elasticache" title="Permanent link">&para;</a></h2>
<p>Conductor server can be used with a standlone Redis or ElastiCache server.  To configure the server, change the config to use the following:</p>
<pre class="codehilite"><code class="language-properties">db=redis

# For AWS Elasticache Redis (cluster mode enabled) the format is configuration_endpoint:port:us-east-1e.
# The region in this case does not matter
workflow.dynomite.cluster.hosts=server_address:server_port:us-east-1e
workflow.dynomite.connection.maxConnsPerHost=31

queues.dynomite.nonQuorum.port=server_port</code></pre>


<h2 id="setting-up-zookeeper-to-enable-distributed-locking-service">Setting up Zookeeper to enable Distributed Locking Service.<a class="headerlink" href="#setting-up-zookeeper-to-enable-distributed-locking-service" title="Permanent link">&para;</a></h2>
<p>See <a href="../technicaldetails/#maintaining-workflow-consistency-with-distributed-locking-and-fencing-tokens">Technical Details</a> for more details about this.</p>
<p>Locking Service is disabled by default. Enable this by setting:</p>
<p><code>decider.locking.enabled: true</code></p>
<p>Setup Zookeeper cluster connection string:</p>
<p><code>zk.connection=1.2.3.4:2181,5.6.7.8:2181</code></p>
<p>Optionally, configure the default timeouts:</p>
<pre class="codehilite"><code>zk.sessionTimeoutMs
zk.connectionTimeoutMs</code></pre>


<h2 id="default-workflow-archiving-module-configuration">Default Workflow Archiving Module Configuration<a class="headerlink" href="#default-workflow-archiving-module-configuration" title="Permanent link">&para;</a></h2>
<p>Conductor server does not perform automated workflow execution data cleaning by default. Archiving module (if enabled) 
removes all execution data from conductor persistence storage immediately upon workflow completion or termination, 
but keeps archived index data in elastic search. </p>
<p>To benefit form archiving module you have to do the following:</p>
<h3 id="1-enable-archiving-module">1. Enable Archiving Module<a class="headerlink" href="#1-enable-archiving-module" title="Permanent link">&para;</a></h3>
<p>Set property in server configuration.</p>
<pre class="codehilite"><code class="language-properties"># Comma-separated additional conductor modules
conductor.additional.modules=com.netflix.conductor.contribs.ArchivingWorkflowModule</code></pre>


<h3 id="2-enable-workflow-status-listener">2. Enable Workflow Status Listener<a class="headerlink" href="#2-enable-workflow-status-listener" title="Permanent link">&para;</a></h3>
<p>Archiving module is triggered only if workflow status listener is enabled on workflow definition level. To enable it 
you have to set <code>workflowStatusListenerEnabled</code> property to <code>true</code>. See sample workflow definition below:</p>
<pre class="codehilite"><code class="language-json">{
  &quot;name&quot;: &quot;e2e_approval_v4&quot;,
  &quot;description&quot;: &quot;Approval Process&quot;,
  &quot;workflowStatusListenerEnabled&quot;: true, 
  &quot;tasks&quot;: []
}</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../apispec/" class="btn btn-neutral float-right" title="API Specification">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../configuration/isolationgroups/" class="btn btn-neutral" title="Isolation Groups"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/Netflix/conductor/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../configuration/isolationgroups/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../apispec/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
